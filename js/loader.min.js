var main,groups,categories,categorieFilter="",newFilter=!0,filterlist=[],activeFilters=[],filterDataElement,language=document.getElementsByTagName("html")[0].getAttribute("lang"),contentMessage={waiting_download:{en:"Waiting for files to download.",nl:"Wacht op het downloaden van de bestanden."},parse_error:{en:"Parsing error file is not valid.",nl:"Bestand bevat fouten."},Loading:{en:"Loading",nl:"Laden"},parsing:{en:"parsing",nl:"analyseren"},New:{en:"New",nl:"Nieuw"},More_Info:{en:"More Info",
nl:"Meer Info"},Featured:{en:"Featured",nl:"Uitgelicht"},Filter_on:{en:"Filter on",nl:"Filter op"},No_object_found:{en:"No object found",nl:"Geen object gevonden"}},toLoad=1,loaded=0,toparse=1,parsed=0,loadingStatus=contentMessage.waiting_download[language],mainCheck=!1;
function loadMain(a){var b;b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){loaded++;updateLoader();try{main=JSON.parse(b.responseText),mainCheck=!0,checkReady()}catch(d){loadingStatus=contentMessage.parse_error[language],updateLoader(),console.log(d)}}};b.open("GET",a,!0);b.send()}
function checkReady(){mainCheck&&(parseCategories(),drawFilterButtons(),drawFeaturedList(),addMoreFilters(),drawGroupList(categorieFilter))}function redraw(){0==activeFilters.length&&drawFeaturedList();drawGroupList(categorieFilter)}function escapeQuotes(a){a=a.replace(/{/g,"(");a=a.replace(/}/g,")");return a.replace(/\"/g,"'")}
function updateLoader(){document.getElementById("groupList").innerHTML="<h2>"+contentMessage.Loading[language]+'<img src="img/ionicons/load-d.svg" width="30" alt="."/></h2><p>Downloading: '+loaded+"/"+toLoad+"</p><p>Parsing: "+parsed+"/"+toparse+"</p><p>Status: "+loadingStatus+"</p>"}function parseCategories(){categories=main.categories}
function drawFeaturedList(){var a="";parsed=0;loadingStatus=contentMessage.parsing[language]+"...";updateLoader();groups=main.groups;a+=drawGroups(groups,!0);document.getElementById("featuredList").innerHTML=a}function drawGroupList(a){var b="";parsed=0;loadingStatus=contentMessage.parsing[language]+"...";updateLoader();groups=main.groups;b+=drawGroups(groups,!1,a);document.getElementById("groupList").innerHTML=b}
function drawGroups(a,b,d){d="";for(var c=0;c<activeFilters.length;c++)filterDataElement=activeFilters[c].filter_data,a=$.map(a,activeFilters[c].filter);a.sort(compareCreationDateReverse);for(c=0;c<a.length;c++){var e=a[c];b?1==e.featured&&(d+=drawFeaturedGroup(e)):d+=drawGroup(e)}return d}function compareCreationDateReverse(a,b){return a.creationDate>b.creationDate?-1:a.creationDate<b.creationDate?1:0}
function drawGroup(a){var b="";creationDate=new Date(a.creationDate);var d="";4>=getWeeksAgo(creationDate)&&(d='<span class="badge badge-primary">'+contentMessage.New[language]+"</span>");var c="";""!=a.logo&&(c='<img class="card-img-top" src="'+main.imgpath+"/"+a.logo+'" alt="">');return b+='<div class="col-sm-12 col-md-6 col-xl-4">\n              <div class="card">\n                '+c+'\n                <div class="card-body">\n                  <h3 class="card-title">'+a.name+" "+d+'</h3>\n                  <p class="card-text">'+
a.description_short[language]+"</p>\n                  <div>"+drawCategoryBadge(a.category)+" "+drawTagBadge(a.tags)+"</div>\n                  "+drawGroupModalButton(a)+"\n                </div>\n              </div>\n            </div>"}
function drawGroupModalButton(a){return""+('<button class="card-link btn btn-light" type="button" data-toggle="modal" data-target="#groepinfoModel"\n             data-group=\''+JSON.stringify(a).replace(/'/g,"\\'")+"'>"+contentMessage.More_Info[language]+"</button>")}
function drawFeaturedGroup(a){var b="";creationDate=new Date(a.creationDate);var d="";4>=getWeeksAgo(creationDate)&&(d='<span class="badge badge-light">'+contentMessage.New[language]+"</span>");var c="";""!=a.logo&&(c='<img class="card-img-top" src="'+main.imgpath+"/"+a.logo+'" alt="">');return b+='<div class="col-sm-12 col-md-6 col-xl-4">\n              <div class="card text-white bg-primary">\n                <div class="card-header">'+contentMessage.Featured[language]+"</div>\n                "+
c+'\n                <div class="card-body">\n                  <h3 class="card-title">'+a.name+" "+d+'</h3>\n                  <p class="card-text">'+a.description_short[language]+"</p>\n                  <div>"+drawCategoryBadge(a.category)+drawTagBadge(a.tags)+"</div>\n                  "+drawGroupModalButton(a)+"\n                </div>\n              </div>\n            </div>"}
function drawCategoryBadge(a){var b="";category=findCategory(a);return null==category?"":b+='<span class="badge" style="'+("color:"+category.color+"; background-color:"+category.bgcolor+";")+'">'+category.name[language]+"</span>"}function drawTagBadge(a){for(var b="",d=0;d<a.length;d++)b+=drawCategoryBadge(a[d])+" ";return b}function getWeeksAgo(a){var b=new Date(Date.now());return Math.floor(Math.abs((b.getTime()-a.getTime())/6048E5))}
function addMoreFilters(){filterlist.push({value:"new",display_text:contentMessage.New[language],display:"<div>"+contentMessage.New[language]+"</div>",filter:function(a){creationDate=new Date(a.creationDate);if(4>=getWeeksAgo(creationDate))return a},badge:'<button type="button" class="btn btn-light filter-new" onclick="removeFilter(\'new\');">\n    <span class="badge badge-primary">'+contentMessage.New[language]+'</span>\n    <img src="img/ionicons/close-circled.svg" width="20"></button>',filter_data:"",
ID:"new"})}function findCategory(a){for(var b=0;b<categories.length;b++)if(categories[b].ID==a)return categories[b];return null}
function drawFilterButtons(){for(var a="",b="",d=0;d<categories.length;d++){var c=categories[d],b=b+('<button type="button" class="dropdown-item"\n    onclick="triggerFilter(\''+c.ID+"');\">"+drawCategoryBadge(c.ID)+"</button>");filterID="category-"+c.name;c={value:c.name[language],display_text:""+c.name[language],display:"<div>"+c.name[language]+"</div>",filter:function(a){if(a.category==filterDataElement)return a},badge:'<button type="button" class="btn btn-light filter-category" onclick="removeFilter(\''+
filterID+"');\">"+drawCategoryBadge(c.ID)+'\n      <img src="img/ionicons/close-circled.svg" width="20"></button>',filter_data:c.ID,ID:filterID};filterlist.push(c)}a+='<div class="btn-toolbar mb-12" role="toolbar" aria-label="FilterToolbar">\n    <div class="btn-group" role="group" aria-label="CategoryFilter">\n      <div class="input-group" id="filterbox">\n        <input type="text" class="form-control typeahead" placeholder="'+contentMessage.Filter_on[language]+' ..." aria-label="FilterField">\n      </div>\n      <div id="filterActive">\n      </div>\n    </div>\n  </div>';
document.getElementById("filterCategory").innerHTML=a;$("#filterbox .typeahead").typeahead({hint:!0,highlight:!0,minLength:1},{name:"filter",source:function(a,b){var c=new RegExp(a,"i"),d=$.map(filterlist,function(a){if(c.test(a.value))return a});b(d)},display:function(a){return a.display_text},templates:{empty:function(){return'<div class="empty-message">'+contentMessage.No_object_found[language]+"</div>"},suggestion:function(a){return a.display}}});$("#filterbox .typeahead").bind("typeahead:select",
function(a,b){activeFilters.push(b);$("#filterbox .typeahead").typeahead("val","");drawFilterBadges();redraw()})}function drawFilterBadges(){for(var a="",b=0;b<activeFilters.length;b++)a+=activeFilters[b].badge;document.getElementById("filterActive").innerHTML=a}function removeFilter(a){for(var b=0;b<activeFilters.length;b++)if(activeFilters[b].ID==a){activeFilters.splice(b,1);break}drawFilterBadges();redraw()};
